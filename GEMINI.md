# feed2cli プロジェクト概要

この `feed2cli` プロジェクトは、RSS/Atomフィードを処理し、その内容を様々な形式で出力するためのCLIツールです。Plaggerにインスパイアされており、フィルタによる柔軟なフィード加工を目指しています。

## 主要な機能と構成

*   **`feed2cli.go`**:
    *   プロジェクトのメインエントリーポイント。
    *   コマンドライン引数の解析、フィードの入力、フィルタ適用、差分検出、マージ、出力処理のオーケストレーションを行います。

*   **入力処理**:
    *   **`input_uri.go`**: URIからフィードを読み込む機能を提供します。
    *   **`input_standerd.go`**: 標準入力からフィードを読み込む機能を提供します。

*   **フィルタ処理**:
    *   **`filter.go`**:
        *   フィードの各エントリに対して汎用的な処理を適用するためのフィルタ機能を提供します。
        *   `Filter` インターフェースを定義し、拡張性を確保しています。
        *   **`HatenaBookmarkFilter`**: はてなブックマークのブックマーク数を取得し、エントリのDescriptionに追記します。将来的には、ブックマークコメントも取得し、エントリに情報を付与する拡張が計画されています。

*   **フィード構造とソート**:
    *   **`sortableFeed.go`**: フィードエントリをソート可能にするための構造体とメソッドを定義しています。主に `time.Time` に基づいてソートされます。
    *   **`sortableFeed_test.go`**: `sortableFeed.go` のテストコードです。

*   **差分検出**:
    *   **`diff.go`**: 新しいフィードと古いフィードの差分を検出し、新しいエントリのみを抽出する機能を提供します。
    *   **`diff_test.go`**: `diff.go` のテストコードです。

*   **マージ処理**:
    *   **`merge.go`**: 複数のフィードをマージする機能を提供します。
    *   **`merge_test.go`**: `merge.go` のテストコードです。

*   **出力処理**:
    *   **`output_standerd.go`**: 標準出力にフィードを出力する機能を提供します。
    *   **`output_slack.go`**: Slack形式でフィードを出力する機能を提供します。
    *   **`output_hatena_slack.go`**:
        *   はてなブックマークの情報を付与したフィードを元に、Slackへ高度な通知を行う機能を提供します。
        *   各RSSエントリに対して、Slack上に親メッセージ（スレッドの起点）を投稿します。
        *   エントリのURLに紐づくはてなブックマークのコメントを取得し、対応するSlackスレッドにコメントとして投稿します。
        *   `hatena_state.json` という状態管理ファイルを使用し、再実行時には新しく投稿されたコメント（差分）のみをスレッドに追加します。これにより、重複投稿を防ぎます。

*   **ユーティリティ**:
    *   **`utils.go`**: 各種ヘルパー関数や共通のユーティリティ機能が含まれています。

## 全体的なワークフロー

フィードの取得、フィルタによる加工（はてなブックマーク情報の付与など）、マージや差分といった集約処理、そして多様な形式での出力という一連のワークフローをCLIで実現しています。
